<?php
/****************************************************************************
 * add.ctp	- Create new callback job
 * version 	- 2.5.1200
 * 
 * Version: MPL 1.1
 *
 * The contents of this file are subject to the Mozilla Public License Version
 * 1.1 (the "License"); you may not use this file except in compliance with
 * the License. You may obtain a copy of the License at
 * http://www.mozilla.org/MPL/
 *
 * Software distributed under the License is distributed on an "AS IS" basis,
 * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
 * for the specific language governing rights and limitations under the
 * License.
 *
 *
 * The Initial Developer of the Original Code is
 *   Louise Berthilson <louise@it46.se>
 *
 *
***************************************************************************/
echo $html->addCrumb('Callback', '/callbacks');
echo $html->addCrumb('Create', '/callbacks/add');
$ivr_settings = Configure::read('IVR_SETTINGS');

     echo "<h1>".__("Create Callback Job",true)."</h1>";
     echo $form->create('Callback',array('type' => 'post','action'=> 'add'));


      echo "<fieldset>";
      echo "<legend>".__('Recipients',true)."</legend>";

      echo "<table cellspacing= 0 class= 'none' >";
      echo $html->tableCells(array (
          array(__("Phone book",true),	$form->input('phone_book_id',array('options' => $phonebooks, 'selected' => $this->data['Callback']['phone_book_id'], 'label'=>false))),
          array(array(__("Select phonebook to dial.",true),"colspan='2' class='formComment'"))
          ), array('class'=>'none'),array('class'=>'none'));
       
      echo "</table>";
      echo "</fieldset>";





       foreach($lam as $key => $entry){
             $lam[$key] = $text->truncate($entry,$ivr_settings['showLengthMin'],false,true,false);
       }
       foreach($ivr as $key => $entry){
             $ivr[$key] = $text->truncate($entry,$ivr_settings['showLengthMin'],false,true,false);
       }
       foreach($selector as $key => $entry){
             $selector[$key] = $text->truncate($entry,$ivr_settings['showLengthMin'],false,true,false);
       }

        $default = false;
     	$options1=array('selector' =>'');
     	$options2=array('ivr' =>'');
     	$options3=array('lam' =>'');

        $attributes=array('legend'=>false,'default'=>$default);

        $radio1 = $form->radio('type',$options1,array('legend' => false, 'default' => true));
	$radio2 = $form->radio('type',$options2,$attributes);
       	$radio3 = $form->radio('type',$options3,$attributes);


        $row[]=array(
	$radio1,$form->input('instance_id',array('type'=>'select','options' => $selector,'label'=>'','empty'=>'- '.__('Select entry',true).' -' )),
	$radio2,$form->input('instance_id',array('type'=>'select','options' => $ivr,'label'=>'','empty'=>'- '.__('Select entry',true).' -' )),
	$radio3,$form->input('instance_id',array('type'=>'select','options' => $lam,'label'=>'','empty'=>'- '.__('Select entry',true).' -' )),
	);



//          array(array(__("Select phonebook to dial.",true),"colspan='2' class='formComment'"))

       $headers = array(array(__('Leave-a-Message',true),array('colspan'=>2)));

       echo "<fieldset>";
       echo "<legend>".__('Service',true)."</legend>";

       echo "<table cellspacing=0 border =1 class='none'>";
       echo $html->tableCells($headers);
       echo $html->tableCells($row, array('class' =>'none'),array('class' =>'none'));
       echo "</table>";
       echo "</fieldset>";


       echo "<fieldset>";
       echo "<legend>".__('Start and end time',true)."</legend>";
       echo "<div class='formComment'>".__("The callback job will start at Start Time. No further attempts for outgoing calls will be made after the End Time.",true)."</div>";

       echo "<table cellspacing = 0 class='none'>";
       echo $html->tableCells(array (
            array(__("Start time",true),	$form->input('start_time',array('label'=>false))),
            array(__("End time",true),		$form->input('end_time',array('label'=>false)))
      ),array('class'=>'none'),array('class'=>'none'));
      echo "</table>";
      echo "</fieldset>";

      echo $form->end(__('Save',true));


?>

